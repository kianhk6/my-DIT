[[34m2025-05-08 18:03:06[0m] Dataset contains 1,300 images (/NAS/Data/imagenet_trucks)
[[34m2025-05-08 18:03:06[0m] Training for 1400 epochs...
[[34m2025-05-08 18:03:06[0m] Beginning epoch 24â€¦
[[34m2025-05-08 18:03:16[0m] Beginning epoch 25â€¦
[[34m2025-05-08 18:03:26[0m] Beginning epoch 26â€¦
[[34m2025-05-08 18:03:36[0m] Beginning epoch 27â€¦
[[34m2025-05-08 18:03:46[0m] Beginning epoch 28â€¦
[[34m2025-05-08 18:03:56[0m] (step=0000600) Train Loss: 0.1934, Train Steps/Sec: 2.01
[[34m2025-05-08 18:03:56[0m] (step=0000600) Train Loss: 0.1934, Train Steps/Sec: 2.01
[[34m2025-05-08 18:03:56[0m] Beginning epoch 29â€¦
[[34m2025-05-08 18:04:06[0m] Beginning epoch 30â€¦
[[34m2025-05-08 18:04:15[0m] Beginning epoch 31â€¦
[[34m2025-05-08 18:04:25[0m] Beginning epoch 32â€¦
[[34m2025-05-08 18:04:35[0m] Beginning epoch 33â€¦
[[34m2025-05-08 18:04:45[0m] (step=0000700) Train Loss: 0.1998, Train Steps/Sec: 2.03
[[34m2025-05-08 18:04:45[0m] (step=0000700) Train Loss: 0.1998, Train Steps/Sec: 2.03
[[34m2025-05-08 18:04:45[0m] Beginning epoch 34â€¦
[[34m2025-05-08 18:04:55[0m] Beginning epoch 35â€¦
[[34m2025-05-08 18:05:05[0m] Beginning epoch 36â€¦
[[34m2025-05-08 18:05:15[0m] Beginning epoch 37â€¦
[[34m2025-05-08 18:05:24[0m] Beginning epoch 38â€¦
[[34m2025-05-08 18:05:34[0m] (step=0000800) Train Loss: 0.2023, Train Steps/Sec: 2.02
[[34m2025-05-08 18:05:34[0m] (step=0000800) Train Loss: 0.2023, Train Steps/Sec: 2.02
[[34m2025-05-08 18:05:34[0m] Beginning epoch 39â€¦
[[34m2025-05-08 18:05:44[0m] Beginning epoch 40â€¦
[[34m2025-05-08 18:05:54[0m] Beginning epoch 41â€¦
[[34m2025-05-08 18:06:04[0m] Beginning epoch 42â€¦
[[34m2025-05-08 18:06:14[0m] Beginning epoch 43â€¦
[[34m2025-05-08 18:06:24[0m] (step=0000900) Train Loss: 0.1957, Train Steps/Sec: 2.01
[[34m2025-05-08 18:06:24[0m] (step=0000900) Train Loss: 0.1957, Train Steps/Sec: 2.01
[[34m2025-05-08 18:06:24[0m] Beginning epoch 44â€¦
[[34m2025-05-08 18:06:34[0m] Beginning epoch 45â€¦
[[34m2025-05-08 18:06:44[0m] Beginning epoch 46â€¦
[[34m2025-05-08 18:06:54[0m] Beginning epoch 47â€¦
[[34m2025-05-08 18:07:04[0m] Beginning epoch 48â€¦
[[34m2025-05-08 18:07:14[0m] (step=0001000) Train Loss: 0.1919, Train Steps/Sec: 2.00
[[34m2025-05-08 18:07:14[0m] (step=0001000) Train Loss: 0.1919, Train Steps/Sec: 2.00
[[34m2025-05-08 18:07:20[0m] Saved checkpoint to /NAS/kian/DiT/023-DiT-S-2/checkpoints/0001000.pt
[[34m2025-05-08 18:07:20[0m] Beginning epoch 49â€¦
[[34m2025-05-08 18:07:30[0m] Beginning epoch 50â€¦
[[34m2025-05-08 18:07:40[0m] Beginning epoch 51â€¦
[[34m2025-05-08 18:07:50[0m] Beginning epoch 52â€¦
[[34m2025-05-08 18:08:00[0m] Beginning epoch 53â€¦
[[34m2025-05-08 18:08:10[0m] (step=0001100) Train Loss: 0.1964, Train Steps/Sec: 1.79
[[34m2025-05-08 18:08:10[0m] (step=0001100) Train Loss: 0.1964, Train Steps/Sec: 1.79
[[34m2025-05-08 18:08:10[0m] Beginning epoch 54â€¦
[[34m2025-05-08 18:08:20[0m] Beginning epoch 55â€¦
[[34m2025-05-08 18:08:30[0m] Beginning epoch 56â€¦
[[34m2025-05-08 18:08:40[0m] Beginning epoch 57â€¦
[[34m2025-05-08 18:08:49[0m] Beginning epoch 58â€¦
[[34m2025-05-08 18:08:59[0m] (step=0001200) Train Loss: 0.1905, Train Steps/Sec: 2.02
[[34m2025-05-08 18:08:59[0m] (step=0001200) Train Loss: 0.1905, Train Steps/Sec: 2.02
[[34m2025-05-08 18:08:59[0m] Beginning epoch 59â€¦
[[34m2025-05-08 18:09:09[0m] Beginning epoch 60â€¦
[[34m2025-05-08 18:09:19[0m] Beginning epoch 61â€¦
[[34m2025-05-08 18:09:29[0m] Beginning epoch 62â€¦
[[34m2025-05-08 18:09:39[0m] Beginning epoch 63â€¦
[[34m2025-05-08 18:09:49[0m] (step=0001300) Train Loss: 0.1917, Train Steps/Sec: 2.01
[[34m2025-05-08 18:09:49[0m] (step=0001300) Train Loss: 0.1917, Train Steps/Sec: 2.01
[[34m2025-05-08 18:09:49[0m] Beginning epoch 64â€¦
[[34m2025-05-08 18:09:59[0m] Beginning epoch 65â€¦
[[34m2025-05-08 18:10:09[0m] Beginning epoch 66â€¦
[[34m2025-05-08 18:10:19[0m] Beginning epoch 67â€¦
[[34m2025-05-08 18:10:29[0m] Beginning epoch 68â€¦
[[34m2025-05-08 18:10:39[0m] (step=0001400) Train Loss: 0.1906, Train Steps/Sec: 2.01
[[34m2025-05-08 18:10:39[0m] (step=0001400) Train Loss: 0.1906, Train Steps/Sec: 2.01
[[34m2025-05-08 18:10:39[0m] Beginning epoch 69â€¦
[[34m2025-05-08 18:10:49[0m] Beginning epoch 70â€¦
[[34m2025-05-08 18:10:59[0m] Beginning epoch 71â€¦
[[34m2025-05-08 18:11:09[0m] Beginning epoch 72â€¦
[[34m2025-05-08 18:11:19[0m] Beginning epoch 73â€¦
[[34m2025-05-08 18:11:28[0m] (step=0001500) Train Loss: 0.1871, Train Steps/Sec: 2.01
[[34m2025-05-08 18:11:28[0m] (step=0001500) Train Loss: 0.1871, Train Steps/Sec: 2.01
[[34m2025-05-08 18:11:33[0m] Saved checkpoint to /NAS/kian/DiT/023-DiT-S-2/checkpoints/0001500.pt
[[34m2025-05-08 18:11:33[0m] Beginning epoch 74â€¦
[[34m2025-05-08 18:11:43[0m] Beginning epoch 75â€¦
[[34m2025-05-08 18:11:53[0m] Beginning epoch 76â€¦
[[34m2025-05-08 18:12:03[0m] Beginning epoch 77â€¦
[[34m2025-05-08 18:12:13[0m] Beginning epoch 78â€¦
[[34m2025-05-08 18:12:22[0m] (step=0001600) Train Loss: 0.1902, Train Steps/Sec: 1.85
[[34m2025-05-08 18:12:22[0m] (step=0001600) Train Loss: 0.1902, Train Steps/Sec: 1.85
[[34m2025-05-08 18:12:22[0m] Beginning epoch 79â€¦
[[34m2025-05-08 18:12:32[0m] Beginning epoch 80â€¦
[[34m2025-05-08 18:12:42[0m] Beginning epoch 81â€¦
[[34m2025-05-08 18:12:52[0m] Beginning epoch 82â€¦
[[34m2025-05-08 18:13:02[0m] Beginning epoch 83â€¦
[[34m2025-05-08 18:13:12[0m] (step=0001700) Train Loss: 0.1900, Train Steps/Sec: 2.01
[[34m2025-05-08 18:13:12[0m] (step=0001700) Train Loss: 0.1900, Train Steps/Sec: 2.01
[[34m2025-05-08 18:13:12[0m] Beginning epoch 84â€¦
[[34m2025-05-08 18:13:22[0m] Beginning epoch 85â€¦
[[34m2025-05-08 18:13:32[0m] Beginning epoch 86â€¦
[[34m2025-05-08 18:13:42[0m] Beginning epoch 87â€¦
[[34m2025-05-08 18:13:52[0m] Beginning epoch 88â€¦
[[34m2025-05-08 18:14:02[0m] (step=0001800) Train Loss: 0.1931, Train Steps/Sec: 2.02
[[34m2025-05-08 18:14:02[0m] (step=0001800) Train Loss: 0.1931, Train Steps/Sec: 2.02
[[34m2025-05-08 18:14:02[0m] Beginning epoch 89â€¦
[[34m2025-05-08 18:14:12[0m] Beginning epoch 90â€¦
[[34m2025-05-08 18:14:22[0m] Beginning epoch 91â€¦
[[34m2025-05-08 18:14:32[0m] Beginning epoch 92â€¦
[[34m2025-05-08 18:14:42[0m] Beginning epoch 93â€¦
[[34m2025-05-08 18:14:52[0m] (step=0001900) Train Loss: 0.1881, Train Steps/Sec: 2.01
[[34m2025-05-08 18:14:52[0m] (step=0001900) Train Loss: 0.1881, Train Steps/Sec: 2.01
[[34m2025-05-08 18:14:52[0m] Beginning epoch 94â€¦
[[34m2025-05-08 18:15:01[0m] Beginning epoch 95â€¦
[[34m2025-05-08 18:15:11[0m] Beginning epoch 96â€¦
[[34m2025-05-08 18:15:21[0m] Beginning epoch 97â€¦
[[34m2025-05-08 18:15:31[0m] Beginning epoch 98â€¦
[[34m2025-05-08 18:15:41[0m] (step=0002000) Train Loss: 0.1901, Train Steps/Sec: 2.01
[[34m2025-05-08 18:15:41[0m] (step=0002000) Train Loss: 0.1901, Train Steps/Sec: 2.01
[[34m2025-05-08 18:15:47[0m] Saved checkpoint to /NAS/kian/DiT/023-DiT-S-2/checkpoints/0002000.pt
[[34m2025-05-08 18:15:47[0m] Beginning epoch 99â€¦
[[34m2025-05-08 18:15:57[0m] Beginning epoch 100â€¦
[[34m2025-05-08 18:16:06[0m] Beginning epoch 101â€¦
[[34m2025-05-08 18:16:16[0m] Beginning epoch 102â€¦
[[34m2025-05-08 18:16:26[0m] Beginning epoch 103â€¦
[[34m2025-05-08 18:16:36[0m] (step=0002100) Train Loss: 0.1907, Train Steps/Sec: 1.82
[[34m2025-05-08 18:16:36[0m] (step=0002100) Train Loss: 0.1907, Train Steps/Sec: 1.82
[[34m2025-05-08 18:16:36[0m] Beginning epoch 104â€¦
[[34m2025-05-08 18:16:46[0m] Beginning epoch 105â€¦
[[34m2025-05-08 18:16:56[0m] Beginning epoch 106â€¦
[[34m2025-05-08 18:17:06[0m] Beginning epoch 107â€¦
[[34m2025-05-08 18:17:16[0m] Beginning epoch 108â€¦
[[34m2025-05-08 18:17:26[0m] (step=0002200) Train Loss: 0.1926, Train Steps/Sec: 2.01
[[34m2025-05-08 18:17:26[0m] (step=0002200) Train Loss: 0.1926, Train Steps/Sec: 2.01
[[34m2025-05-08 18:17:26[0m] Beginning epoch 109â€¦
[[34m2025-05-08 18:17:36[0m] Beginning epoch 110â€¦
[[34m2025-05-08 18:17:46[0m] Beginning epoch 111â€¦
[[34m2025-05-08 18:17:56[0m] Beginning epoch 112â€¦
[[34m2025-05-08 18:18:05[0m] Beginning epoch 113â€¦
[[34m2025-05-08 18:18:15[0m] (step=0002300) Train Loss: 0.1917, Train Steps/Sec: 2.02
[[34m2025-05-08 18:18:15[0m] (step=0002300) Train Loss: 0.1917, Train Steps/Sec: 2.02
[[34m2025-05-08 18:18:15[0m] Beginning epoch 114â€¦
[[34m2025-05-08 18:18:25[0m] Beginning epoch 115â€¦
[[34m2025-05-08 18:18:35[0m] Beginning epoch 116â€¦
[[34m2025-05-08 18:18:45[0m] Beginning epoch 117â€¦
[[34m2025-05-08 18:18:55[0m] Beginning epoch 118â€¦
[[34m2025-05-08 18:19:05[0m] (step=0002400) Train Loss: 0.1835, Train Steps/Sec: 2.01
[[34m2025-05-08 18:19:05[0m] (step=0002400) Train Loss: 0.1835, Train Steps/Sec: 2.01
[[34m2025-05-08 18:19:05[0m] Beginning epoch 119â€¦
[[34m2025-05-08 18:19:15[0m] Beginning epoch 120â€¦
[[34m2025-05-08 18:19:25[0m] Beginning epoch 121â€¦
[[34m2025-05-08 18:19:35[0m] Beginning epoch 122â€¦
[[34m2025-05-08 18:19:45[0m] Beginning epoch 123â€¦
[[34m2025-05-08 18:19:55[0m] (step=0002500) Train Loss: 0.1908, Train Steps/Sec: 2.01
[[34m2025-05-08 18:19:55[0m] (step=0002500) Train Loss: 0.1908, Train Steps/Sec: 2.01
[[34m2025-05-08 18:20:04[0m] Saved checkpoint to /NAS/kian/DiT/023-DiT-S-2/checkpoints/0002500.pt
[[34m2025-05-08 18:20:04[0m] Beginning epoch 124â€¦
[[34m2025-05-08 18:20:14[0m] Beginning epoch 125â€¦
[[34m2025-05-08 18:20:24[0m] Beginning epoch 126â€¦
[[34m2025-05-08 18:20:34[0m] Beginning epoch 127â€¦
[[34m2025-05-08 18:20:44[0m] Beginning epoch 128â€¦
[[34m2025-05-08 18:20:54[0m] (step=0002600) Train Loss: 0.1860, Train Steps/Sec: 1.69
[[34m2025-05-08 18:20:54[0m] (step=0002600) Train Loss: 0.1860, Train Steps/Sec: 1.69
[[34m2025-05-08 18:20:54[0m] Beginning epoch 129â€¦
[[34m2025-05-08 18:21:04[0m] Beginning epoch 130â€¦
[[34m2025-05-08 18:21:14[0m] Beginning epoch 131â€¦
[[34m2025-05-08 18:21:24[0m] Beginning epoch 132â€¦
[[34m2025-05-08 18:21:34[0m] Beginning epoch 133â€¦
[[34m2025-05-08 18:21:44[0m] (step=0002700) Train Loss: 0.1817, Train Steps/Sec: 2.01
[[34m2025-05-08 18:21:44[0m] (step=0002700) Train Loss: 0.1817, Train Steps/Sec: 2.01
[[34m2025-05-08 18:21:44[0m] Beginning epoch 134â€¦
[[34m2025-05-08 18:21:54[0m] Beginning epoch 135â€¦
[[34m2025-05-08 18:22:03[0m] Beginning epoch 136â€¦
[[34m2025-05-08 18:22:13[0m] Beginning epoch 137â€¦
[[34m2025-05-08 18:22:23[0m] Beginning epoch 138â€¦
[[34m2025-05-08 18:22:33[0m] (step=0002800) Train Loss: 0.1868, Train Steps/Sec: 2.01
[[34m2025-05-08 18:22:33[0m] (step=0002800) Train Loss: 0.1868, Train Steps/Sec: 2.01
[[34m2025-05-08 18:22:33[0m] Beginning epoch 139â€¦
[[34m2025-05-08 18:22:43[0m] Beginning epoch 140â€¦
[[34m2025-05-08 18:22:53[0m] Beginning epoch 141â€¦
[[34m2025-05-08 18:23:03[0m] Beginning epoch 142â€¦
[[34m2025-05-08 18:23:13[0m] Beginning epoch 143â€¦
[[34m2025-05-08 18:23:23[0m] (step=0002900) Train Loss: 0.1849, Train Steps/Sec: 2.01
[[34m2025-05-08 18:23:23[0m] (step=0002900) Train Loss: 0.1849, Train Steps/Sec: 2.01
[[34m2025-05-08 18:23:23[0m] Beginning epoch 144â€¦
[[34m2025-05-08 18:23:33[0m] Beginning epoch 145â€¦
[[34m2025-05-08 18:23:43[0m] Beginning epoch 146â€¦
[[34m2025-05-08 18:23:53[0m] Beginning epoch 147â€¦
[[34m2025-05-08 18:24:03[0m] Beginning epoch 148â€¦
[[34m2025-05-08 18:24:13[0m] (step=0003000) Train Loss: 0.1825, Train Steps/Sec: 2.01
[[34m2025-05-08 18:24:13[0m] (step=0003000) Train Loss: 0.1825, Train Steps/Sec: 2.01
[[34m2025-05-08 18:24:24[0m] Saved checkpoint to /NAS/kian/DiT/023-DiT-S-2/checkpoints/0003000.pt
[[34m2025-05-08 18:24:24[0m] Beginning epoch 149â€¦
[[34m2025-05-08 18:24:34[0m] Beginning epoch 150â€¦
Traceback (most recent call last):
  File "/home/kha98/Desktop/DiT/train.py", line 354, in <module>
  File "/home/kha98/Desktop/DiT/train.py", line 281, in main
    loss_dict = diffusion.training_losses(model, x, t, model_kwargs)
  File "/home/kha98/Desktop/DiT/diffusion/respace.py", line 97, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 731, in training_losses
    x_t = self.q_sample(x_start, t, noise=noise)
  File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 228, in q_sample
    _extract_into_tensor(self.sqrt_alphas_cumprod, t, x_start.shape) * x_start
  File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 870, in _extract_into_tensor
    res = th.from_numpy(arr).to(device=timesteps.device)[timesteps].float()
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/kha98/Desktop/DiT/train.py", line 354, in <module>
[rank0]:   File "/home/kha98/Desktop/DiT/train.py", line 281, in main
[rank0]:     loss_dict = diffusion.training_losses(model, x, t, model_kwargs)
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/respace.py", line 97, in training_losses
[rank0]:     return super().training_losses(self._wrap_model(model), *args, **kwargs)
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 731, in training_losses
[rank0]:     x_t = self.q_sample(x_start, t, noise=noise)
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 228, in q_sample
[rank0]:     _extract_into_tensor(self.sqrt_alphas_cumprod, t, x_start.shape) * x_start
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 870, in _extract_into_tensor
[rank0]:     res = th.from_numpy(arr).to(device=timesteps.device)[timesteps].float()
[rank0]: KeyboardInterrupt
