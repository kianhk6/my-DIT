[[34m2025-05-08 16:59:35[0m] Training for 1400 epochs...
[[34m2025-05-08 16:59:35[0m] Beginning epoch 0â€¦
[[34m2025-05-08 16:59:45[0m] Beginning epoch 1â€¦
[[34m2025-05-08 16:59:55[0m] Beginning epoch 2â€¦
[[34m2025-05-08 17:00:05[0m] Beginning epoch 3â€¦
[[34m2025-05-08 17:00:15[0m] Beginning epoch 4â€¦
[[34m2025-05-08 17:00:24[0m] (step=0000100) Train Loss: 0.4678, Train Steps/Sec: 1.98
[[34m2025-05-08 17:00:24[0m] (step=0000100) Train Loss: 0.4678, Train Steps/Sec: 1.98
[[34m2025-05-08 17:00:24[0m] Beginning epoch 5â€¦
[[34m2025-05-08 17:00:34[0m] Beginning epoch 6â€¦
[[34m2025-05-08 17:00:44[0m] Beginning epoch 7â€¦
[[34m2025-05-08 17:00:54[0m] Beginning epoch 8â€¦
[[34m2025-05-08 17:01:04[0m] Beginning epoch 9â€¦
[[34m2025-05-08 17:01:14[0m] (step=0000200) Train Loss: 0.2166, Train Steps/Sec: 2.04
[[34m2025-05-08 17:01:14[0m] (step=0000200) Train Loss: 0.2166, Train Steps/Sec: 2.04
[[34m2025-05-08 17:01:14[0m] Beginning epoch 10â€¦
[[34m2025-05-08 17:01:23[0m] Beginning epoch 11â€¦
[[34m2025-05-08 17:01:33[0m] Beginning epoch 12â€¦
[[34m2025-05-08 17:01:43[0m] Beginning epoch 13â€¦
[[34m2025-05-08 17:01:53[0m] Beginning epoch 14â€¦
[[34m2025-05-08 17:02:03[0m] (step=0000300) Train Loss: 0.2123, Train Steps/Sec: 2.04
[[34m2025-05-08 17:02:03[0m] (step=0000300) Train Loss: 0.2123, Train Steps/Sec: 2.04
[[34m2025-05-08 17:02:03[0m] Beginning epoch 15â€¦
[[34m2025-05-08 17:02:13[0m] Beginning epoch 16â€¦
[[34m2025-05-08 17:02:22[0m] Beginning epoch 17â€¦
[[34m2025-05-08 17:02:32[0m] Beginning epoch 18â€¦
[[34m2025-05-08 17:02:42[0m] Beginning epoch 19â€¦
[[34m2025-05-08 17:02:52[0m] (step=0000400) Train Loss: 0.2024, Train Steps/Sec: 2.03
[[34m2025-05-08 17:02:52[0m] (step=0000400) Train Loss: 0.2024, Train Steps/Sec: 2.03
[[34m2025-05-08 17:02:52[0m] Beginning epoch 20â€¦
[[34m2025-05-08 17:03:02[0m] Beginning epoch 21â€¦
[[34m2025-05-08 17:03:12[0m] Beginning epoch 22â€¦
[[34m2025-05-08 17:03:22[0m] Beginning epoch 23â€¦
[[34m2025-05-08 17:03:31[0m] Beginning epoch 24â€¦
[[34m2025-05-08 17:03:41[0m] (step=0000500) Train Loss: 0.1967, Train Steps/Sec: 2.03
[[34m2025-05-08 17:03:41[0m] (step=0000500) Train Loss: 0.1967, Train Steps/Sec: 2.03
[[34m2025-05-08 17:03:46[0m] Saved checkpoint to /NAS/kian/DiT/014-DiT-S-2/checkpoints/0000500.pt
[[34m2025-05-08 17:03:46[0m] Beginning epoch 25â€¦
[[34m2025-05-08 17:03:56[0m] Beginning epoch 26â€¦
[[34m2025-05-08 17:04:05[0m] Beginning epoch 27â€¦
[[34m2025-05-08 17:04:15[0m] Beginning epoch 28â€¦
[[34m2025-05-08 17:04:25[0m] Beginning epoch 29â€¦
[[34m2025-05-08 17:04:35[0m] (step=0000600) Train Loss: 0.2007, Train Steps/Sec: 1.86
[[34m2025-05-08 17:04:35[0m] (step=0000600) Train Loss: 0.2007, Train Steps/Sec: 1.86
[[34m2025-05-08 17:04:35[0m] Beginning epoch 30â€¦
[[34m2025-05-08 17:04:45[0m] Beginning epoch 31â€¦
[[34m2025-05-08 17:04:55[0m] Beginning epoch 32â€¦
[[34m2025-05-08 17:05:05[0m] Beginning epoch 33â€¦
[[34m2025-05-08 17:05:14[0m] Beginning epoch 34â€¦
[[34m2025-05-08 17:05:24[0m] (step=0000700) Train Loss: 0.1947, Train Steps/Sec: 2.03
[[34m2025-05-08 17:05:24[0m] (step=0000700) Train Loss: 0.1947, Train Steps/Sec: 2.03
[[34m2025-05-08 17:05:24[0m] Beginning epoch 35â€¦
[[34m2025-05-08 17:05:34[0m] Beginning epoch 36â€¦
[[34m2025-05-08 17:05:44[0m] Beginning epoch 37â€¦
[[34m2025-05-08 17:05:54[0m] Beginning epoch 38â€¦
[[34m2025-05-08 17:06:04[0m] Beginning epoch 39â€¦
[[34m2025-05-08 17:06:14[0m] (step=0000800) Train Loss: 0.1956, Train Steps/Sec: 2.02
[[34m2025-05-08 17:06:14[0m] (step=0000800) Train Loss: 0.1956, Train Steps/Sec: 2.02
[[34m2025-05-08 17:06:14[0m] Beginning epoch 40â€¦
[[34m2025-05-08 17:06:24[0m] Beginning epoch 41â€¦
[[34m2025-05-08 17:06:34[0m] Beginning epoch 42â€¦
[[34m2025-05-08 17:06:44[0m] Beginning epoch 43â€¦
[[34m2025-05-08 17:06:53[0m] Beginning epoch 44â€¦
[[34m2025-05-08 17:07:03[0m] (step=0000900) Train Loss: 0.1943, Train Steps/Sec: 2.02
[[34m2025-05-08 17:07:03[0m] (step=0000900) Train Loss: 0.1943, Train Steps/Sec: 2.02
[[34m2025-05-08 17:07:03[0m] Beginning epoch 45â€¦
[[34m2025-05-08 17:07:13[0m] Beginning epoch 46â€¦
[[34m2025-05-08 17:07:23[0m] Beginning epoch 47â€¦
[[34m2025-05-08 17:07:33[0m] Beginning epoch 48â€¦
[[34m2025-05-08 17:07:43[0m] Beginning epoch 49â€¦
[[34m2025-05-08 17:07:53[0m] (step=0001000) Train Loss: 0.1901, Train Steps/Sec: 2.02
[[34m2025-05-08 17:07:53[0m] (step=0001000) Train Loss: 0.1901, Train Steps/Sec: 2.02
[[34m2025-05-08 17:08:01[0m] Saved checkpoint to /NAS/kian/DiT/014-DiT-S-2/checkpoints/0001000.pt
[[34m2025-05-08 17:08:01[0m] Beginning epoch 50â€¦
[[34m2025-05-08 17:08:11[0m] Beginning epoch 51â€¦
[[34m2025-05-08 17:08:20[0m] Beginning epoch 52â€¦
[[34m2025-05-08 17:08:30[0m] Beginning epoch 53â€¦
[[34m2025-05-08 17:08:40[0m] Beginning epoch 54â€¦
[[34m2025-05-08 17:08:50[0m] (step=0001100) Train Loss: 0.1931, Train Steps/Sec: 1.75
[[34m2025-05-08 17:08:50[0m] (step=0001100) Train Loss: 0.1931, Train Steps/Sec: 1.75
[[34m2025-05-08 17:08:50[0m] Beginning epoch 55â€¦
[[34m2025-05-08 17:09:00[0m] Beginning epoch 56â€¦
[[34m2025-05-08 17:09:10[0m] Beginning epoch 57â€¦
[[34m2025-05-08 17:09:20[0m] Beginning epoch 58â€¦
[[34m2025-05-08 17:09:30[0m] Beginning epoch 59â€¦
[[34m2025-05-08 17:09:39[0m] (step=0001200) Train Loss: 0.1933, Train Steps/Sec: 2.02
[[34m2025-05-08 17:09:39[0m] (step=0001200) Train Loss: 0.1933, Train Steps/Sec: 2.02
[[34m2025-05-08 17:09:39[0m] Beginning epoch 60â€¦
[[34m2025-05-08 17:09:49[0m] Beginning epoch 61â€¦
[[34m2025-05-08 17:09:59[0m] Beginning epoch 62â€¦
[[34m2025-05-08 17:10:09[0m] Beginning epoch 63â€¦
[[34m2025-05-08 17:10:19[0m] Beginning epoch 64â€¦
[[34m2025-05-08 17:10:29[0m] (step=0001300) Train Loss: 0.1957, Train Steps/Sec: 2.02
[[34m2025-05-08 17:10:29[0m] (step=0001300) Train Loss: 0.1957, Train Steps/Sec: 2.02
[[34m2025-05-08 17:10:29[0m] Beginning epoch 65â€¦
[[34m2025-05-08 17:10:39[0m] Beginning epoch 66â€¦
[[34m2025-05-08 17:10:49[0m] Beginning epoch 67â€¦
[[34m2025-05-08 17:10:59[0m] Beginning epoch 68â€¦
[[34m2025-05-08 17:11:09[0m] Beginning epoch 69â€¦
[[34m2025-05-08 17:11:18[0m] (step=0001400) Train Loss: 0.1911, Train Steps/Sec: 2.02
[[34m2025-05-08 17:11:18[0m] (step=0001400) Train Loss: 0.1911, Train Steps/Sec: 2.02
[[34m2025-05-08 17:11:19[0m] Beginning epoch 70â€¦
[[34m2025-05-08 17:11:28[0m] Beginning epoch 71â€¦
[[34m2025-05-08 17:11:38[0m] Beginning epoch 72â€¦
[[34m2025-05-08 17:11:48[0m] Beginning epoch 73â€¦
[[34m2025-05-08 17:11:58[0m] Beginning epoch 74â€¦
[[34m2025-05-08 17:12:08[0m] (step=0001500) Train Loss: 0.1926, Train Steps/Sec: 2.02
[[34m2025-05-08 17:12:08[0m] (step=0001500) Train Loss: 0.1926, Train Steps/Sec: 2.02
[[34m2025-05-08 17:12:13[0m] Saved checkpoint to /NAS/kian/DiT/014-DiT-S-2/checkpoints/0001500.pt
[[34m2025-05-08 17:12:13[0m] Beginning epoch 75â€¦
[[34m2025-05-08 17:12:23[0m] Beginning epoch 76â€¦
[[34m2025-05-08 17:12:33[0m] Beginning epoch 77â€¦
[[34m2025-05-08 17:12:43[0m] Beginning epoch 78â€¦
[[34m2025-05-08 17:12:53[0m] Beginning epoch 79â€¦
[[34m2025-05-08 17:13:02[0m] (step=0001600) Train Loss: 0.1934, Train Steps/Sec: 1.84
[[34m2025-05-08 17:13:02[0m] (step=0001600) Train Loss: 0.1934, Train Steps/Sec: 1.84
[[34m2025-05-08 17:13:02[0m] Beginning epoch 80â€¦
[[34m2025-05-08 17:13:12[0m] Beginning epoch 81â€¦
[[34m2025-05-08 17:13:22[0m] Beginning epoch 82â€¦
[[34m2025-05-08 17:13:32[0m] Beginning epoch 83â€¦
[[34m2025-05-08 17:13:42[0m] Beginning epoch 84â€¦
[[34m2025-05-08 17:13:52[0m] (step=0001700) Train Loss: 0.1950, Train Steps/Sec: 2.02
[[34m2025-05-08 17:13:52[0m] (step=0001700) Train Loss: 0.1950, Train Steps/Sec: 2.02
[[34m2025-05-08 17:13:52[0m] Beginning epoch 85â€¦
[[34m2025-05-08 17:14:02[0m] Beginning epoch 86â€¦
[[34m2025-05-08 17:14:12[0m] Beginning epoch 87â€¦
[[34m2025-05-08 17:14:22[0m] Beginning epoch 88â€¦
[[34m2025-05-08 17:14:31[0m] Beginning epoch 89â€¦
[[34m2025-05-08 17:14:41[0m] (step=0001800) Train Loss: 0.1940, Train Steps/Sec: 2.02
[[34m2025-05-08 17:14:41[0m] (step=0001800) Train Loss: 0.1940, Train Steps/Sec: 2.02
[[34m2025-05-08 17:14:41[0m] Beginning epoch 90â€¦
[[34m2025-05-08 17:14:51[0m] Beginning epoch 91â€¦
[[34m2025-05-08 17:15:01[0m] Beginning epoch 92â€¦
[[34m2025-05-08 17:15:11[0m] Beginning epoch 93â€¦
[[34m2025-05-08 17:15:21[0m] Beginning epoch 94â€¦
[[34m2025-05-08 17:15:31[0m] (step=0001900) Train Loss: 0.1856, Train Steps/Sec: 2.02
[[34m2025-05-08 17:15:31[0m] (step=0001900) Train Loss: 0.1856, Train Steps/Sec: 2.02
[[34m2025-05-08 17:15:31[0m] Beginning epoch 95â€¦
[[34m2025-05-08 17:15:41[0m] Beginning epoch 96â€¦
[[34m2025-05-08 17:15:51[0m] Beginning epoch 97â€¦
[[34m2025-05-08 17:16:01[0m] Beginning epoch 98â€¦
[[34m2025-05-08 17:16:10[0m] Beginning epoch 99â€¦
[[34m2025-05-08 17:16:20[0m] (step=0002000) Train Loss: 0.1929, Train Steps/Sec: 2.02
[[34m2025-05-08 17:16:20[0m] (step=0002000) Train Loss: 0.1929, Train Steps/Sec: 2.02
[[34m2025-05-08 17:16:28[0m] Saved checkpoint to /NAS/kian/DiT/014-DiT-S-2/checkpoints/0002000.pt
[[34m2025-05-08 17:16:28[0m] Beginning epoch 100â€¦
[[34m2025-05-08 17:16:38[0m] Beginning epoch 101â€¦
[[34m2025-05-08 17:16:47[0m] Beginning epoch 102â€¦
Traceback (most recent call last):
  File "/home/kha98/Desktop/DiT/train.py", line 328, in <module>
    main(args)
  File "/home/kha98/Desktop/DiT/train.py", line 256, in main
    loss_dict = diffusion.training_losses(model, x, t, model_kwargs)
  File "/home/kha98/Desktop/DiT/diffusion/respace.py", line 97, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 731, in training_losses
    x_t = self.q_sample(x_start, t, noise=noise)
  File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 228, in q_sample
    _extract_into_tensor(self.sqrt_alphas_cumprod, t, x_start.shape) * x_start
  File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 870, in _extract_into_tensor
    res = th.from_numpy(arr).to(device=timesteps.device)[timesteps].float()
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/kha98/Desktop/DiT/train.py", line 328, in <module>
[rank0]:     main(args)
[rank0]:   File "/home/kha98/Desktop/DiT/train.py", line 256, in main
[rank0]:     loss_dict = diffusion.training_losses(model, x, t, model_kwargs)
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/respace.py", line 97, in training_losses
[rank0]:     return super().training_losses(self._wrap_model(model), *args, **kwargs)
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 731, in training_losses
[rank0]:     x_t = self.q_sample(x_start, t, noise=noise)
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 228, in q_sample
[rank0]:     _extract_into_tensor(self.sqrt_alphas_cumprod, t, x_start.shape) * x_start
[rank0]:   File "/home/kha98/Desktop/DiT/diffusion/gaussian_diffusion.py", line 870, in _extract_into_tensor
[rank0]:     res = th.from_numpy(arr).to(device=timesteps.device)[timesteps].float()
[rank0]: KeyboardInterrupt
